series: focal
applications:
  pgbouncer:
    charm: cs:pgbouncer
    channel: edge
    revision: 6 # TODO latest version is 7 - add scaling tests!
    num_units: 1
    to:
    - "1"
    constraints: arch=amd64
  postgresql:
    charm: cs:postgresql
    channel: edge
    revision: 254
    resources:
      patroni: 1
    num_units: 1
    to:
    - "0"
    constraints: arch=amd64
    storage:
      pgdata: rootfs,1,1024M
    trust: true
machines:
  "0":
    constraints: arch=amd64
  "1":
    constraints: arch=amd64
relations:
- - pgbouncer:backend-database
  - postgresql:database
